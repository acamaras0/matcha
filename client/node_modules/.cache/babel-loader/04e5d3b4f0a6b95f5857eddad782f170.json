{"ast":null,"code":"var _jsxFileName = \"/opt/lampstack-8.1.7-0/apache2/htdocs/matcha-2.0/client/src/components/MainPage/MainPage.js\";\nimport React, { useEffect, useState } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport UserCard from './UserCard/UserCard';\nimport Filter from './Filter/Filter';\nimport Footer from './Footer/Footer';\nimport axios from 'axios';\nimport { useSelector } from \"react-redux\";\nconst useStyles = makeStyles(theme => ({\n  root: {\n    paddingTop: '50px'\n  },\n  control: {\n    padding: theme.spacing(5)\n  }\n}));\n\nconst getPreferences = orientation => {\n  switch (orientation) {\n    case 'pansexual':\n      return ['man', 'woman', 'other'];\n\n    case 'gynesexual':\n      return ['woman', 'other'];\n\n    case 'androsexual':\n      return ['man', 'other'];\n  }\n};\n\nconst MainPage = () => {\n  const {\n    user\n  } = useSelector(state => state.auth);\n  const initialGenders = getPreferences(user.orientation);\n  const [spacing, setSpacing] = useState(8);\n  const [distance, setDistance] = useState(500);\n  const [users, setUsers] = useState([]);\n  const [displayedUsers, setDisplayedUsers] = useState([]);\n  const [sort, setSort] = useState('default');\n  const [filteredGenders, setGenderFilter] = useState(initialGenders);\n  const classes = useStyles();\n\n  const handleDistance = (event, value) => {\n    setDistance(value);\n    setGenderFilter(initialGenders);\n  };\n\n  const handleSort = (event, sort = null) => {\n    let sorted;\n    if (event) sort = null;\n\n    switch (sort || event.target.value) {\n      case 'score':\n        setSort('score');\n        sorted = users;\n        sorted.sort((a, b) => {\n          return a.popularity_score < b.popularity_score ? 1 : -1;\n        });\n        setDisplayedUsers(sorted);\n        break;\n\n      case 'distance':\n        setSort('distance');\n        sorted = users;\n        sorted.sort((a, b) => {\n          return a.distance_in_miles > b.distance_in_miles ? 1 : -1;\n        });\n        setDisplayedUsers(sorted);\n        break;\n\n      case 'tags':\n        setSort('tags');\n        sorted = users;\n        sorted.sort((a, b) => {\n          return a.tags_in_common < b.tags_in_common ? 1 : -1;\n        });\n        setDisplayedUsers(sorted);\n        break;\n\n      case 'default':\n        setSort('default');\n        sorted = users;\n        setDisplayedUsers(sorted);\n        break;\n    }\n  };\n\n  const handleFilter = gender => {\n    if (filteredGenders.includes(gender)) setGenderFilter(filteredGenders.filter(g => g !== gender));else setGenderFilter([...filteredGenders, gender]);\n    handleSort(null, sort);\n  };\n\n  useEffect(() => {\n    const source = axios.CancelToken.source();\n\n    const getUsers = async () => {\n      try {\n        const response = await axios.get(`http://localhost:3001/api/matches/${distance}`, {\n          cancelToken: source.token\n        });\n        setUsers(response.data);\n      } catch (error) {\n        if (axios.isCancel(error)) {} else {\n          throw error;\n        }\n      }\n    };\n\n    getUsers();\n    return () => {\n      source.cancel();\n    };\n  }, [distance, displayedUsers[0]]);\n  useEffect(() => {\n    if (users) setDisplayedUsers(users);\n  }, [users.length]);\n  useEffect(() => {\n    const sorted = displayedUsers.filter(user => filteredGenders.includes(user.gender));\n    setDisplayedUsers(sorted);\n  }, [filteredGenders.length]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Filter, {\n    distance: distance,\n    handleDistance: handleDistance,\n    users: users,\n    handleSort: handleSort,\n    sort: sort,\n    handleFilter: handleFilter,\n    genderList: initialGenders,\n    selectedGenders: filteredGenders,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    className: classes.root,\n    spacing: 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    justify: \"center\",\n    spacing: spacing,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 9\n    }\n  }, displayedUsers.map(user => /*#__PURE__*/React.createElement(Grid, {\n    key: user.uid,\n    item: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(UserCard, {\n    className: classes.paper,\n    user: user,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 15\n    }\n  })))))), /*#__PURE__*/React.createElement(Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 5\n    }\n  }));\n};\n\nexport default MainPage;","map":{"version":3,"sources":["/opt/lampstack-8.1.7-0/apache2/htdocs/matcha-2.0/client/src/components/MainPage/MainPage.js"],"names":["React","useEffect","useState","makeStyles","Grid","UserCard","Filter","Footer","axios","useSelector","useStyles","theme","root","paddingTop","control","padding","spacing","getPreferences","orientation","MainPage","user","state","auth","initialGenders","setSpacing","distance","setDistance","users","setUsers","displayedUsers","setDisplayedUsers","sort","setSort","filteredGenders","setGenderFilter","classes","handleDistance","event","value","handleSort","sorted","target","a","b","popularity_score","distance_in_miles","tags_in_common","handleFilter","gender","includes","filter","g","source","CancelToken","getUsers","response","get","cancelToken","token","data","error","isCancel","cancel","length","map","uid","paper"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport UserCard from './UserCard/UserCard';\r\nimport Filter from './Filter/Filter';\r\nimport Footer from './Footer/Footer';\r\nimport axios from 'axios';\r\nimport {useSelector} from \"react-redux\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    paddingTop: '50px',\r\n  },\r\n  control: {\r\n    padding: theme.spacing(5),\r\n  },\r\n}));\r\n\r\nconst getPreferences = (orientation) => {\r\n  switch (orientation) {\r\n    case 'pansexual':\r\n      return ['man', 'woman', 'other']\r\n    case 'gynesexual':\r\n      return ['woman', 'other']\r\n    case 'androsexual':\r\n       return ['man', 'other']\r\n  }\r\n}\r\n\r\n\r\nconst MainPage = () => {\r\n  const {user} = useSelector(state => state.auth);\r\n  const initialGenders = getPreferences(user.orientation)\r\n  const [spacing, setSpacing] = useState(8);\r\n  const [distance, setDistance] = useState(500);\r\n  const [users, setUsers] = useState([]);\r\n  const [displayedUsers, setDisplayedUsers] = useState([]);\r\n  const [sort, setSort] = useState('default');\r\n  const [filteredGenders, setGenderFilter] = useState(initialGenders);\r\n  const classes = useStyles();\r\n\r\n  const handleDistance = (event, value) => {\r\n    setDistance(value)\r\n    setGenderFilter(initialGenders)\r\n  }\r\n\r\n  const handleSort = (event, sort = null) => {\r\n    let sorted;\r\n    if (event) sort = null\r\n    switch (sort || event.target.value ) {\r\n      case 'score':\r\n        setSort('score');\r\n        sorted = users;\r\n        sorted.sort((a, b) => {\r\n          return (a.popularity_score < b.popularity_score) ? 1 : -1\r\n        })\r\n        setDisplayedUsers(sorted)\r\n        break;\r\n      case 'distance':\r\n        setSort('distance');\r\n        sorted = users;\r\n        sorted.sort((a, b) => {\r\n          return (a.distance_in_miles > b.distance_in_miles) ? 1 : -1\r\n        })\r\n        setDisplayedUsers(sorted)\r\n        break;\r\n      case 'tags':\r\n        setSort('tags');\r\n        sorted = users;\r\n        sorted.sort((a, b) => {\r\n          return (a.tags_in_common < b.tags_in_common) ? 1 : -1\r\n        })\r\n        setDisplayedUsers(sorted)\r\n        break;\r\n      case 'default':\r\n        setSort('default')\r\n        sorted = users;\r\n        setDisplayedUsers(sorted)\r\n        break;\r\n    }\r\n  }\r\n\r\n  const handleFilter = (gender) => {\r\n     if (filteredGenders.includes(gender))\r\n         setGenderFilter(filteredGenders.filter(g => g !== gender))\r\n      else\r\n       setGenderFilter([...filteredGenders, gender])\r\n    handleSort(null, sort);\r\n    }\r\n\r\n  useEffect(() => {\r\n    const source = axios.CancelToken.source()\r\n\r\n    const getUsers = async () => {\r\n      try {\r\n        const response = await axios.get(`http://localhost:3001/api/matches/${distance}`, {\r\n          cancelToken: source.token,\r\n        })\r\n        setUsers(response.data)\r\n      } catch (error) {\r\n        if (axios.isCancel(error)) {\r\n        } else {\r\n          throw error;\r\n        }\r\n      }\r\n    }\r\n    getUsers();\r\n    return () => {\r\n      source.cancel();\r\n    }\r\n  }, [distance, displayedUsers[0]])\r\n\r\n  useEffect(() => {\r\n    if (users) setDisplayedUsers(users)\r\n  }, [users.length])\r\n\r\n  useEffect(() => {\r\n    const sorted = displayedUsers.filter(user => filteredGenders.includes(user.gender))\r\n    setDisplayedUsers(sorted);\r\n  }, [filteredGenders.length])\r\n\r\n  return (\r\n    <>\r\n    <Filter distance={distance}\r\n            handleDistance={handleDistance}\r\n            users={users}\r\n            handleSort={handleSort}\r\n            sort={sort}\r\n            handleFilter={handleFilter}\r\n            genderList={initialGenders}\r\n            selectedGenders={filteredGenders}\r\n    />\r\n      <Grid container className={classes.root} spacing={2}>\r\n      <Grid item xs>\r\n        <Grid container justify=\"center\" spacing={spacing}>\r\n          {displayedUsers.map(user => (\r\n            <Grid key={user.uid} item>\r\n              <UserCard className={classes.paper} user={user}/>\r\n            </Grid>\r\n          ))}\r\n        </Grid>\r\n      </Grid>\r\n    </Grid>\r\n    <Footer />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MainPage;"]},"metadata":{},"sourceType":"module"}