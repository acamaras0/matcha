{"ast":null,"code":"var _jsxFileName = \"/opt/lampstack-8.1.7-0/apache2/htdocs/matcha-2.0/client/src/App.js\";\nimport React, { useEffect, useState } from 'react';\nimport { Switch, Route, Redirect } from \"react-router-dom\";\nimport './App.css';\nimport Messenger from './components/MainPage/Messenger/Messenger';\nimport MyAccount from \"./components/MainPage/MyAccount/MyAccount\";\nimport LoginForm from \"./components/LoginForm/LoginForm\";\nimport Profile from './components/MainPage/Profile/Profile';\nimport UserProfile from './components/MainPage/UserProfile/UserProfile';\nimport Navbar from './components/MainPage/Navbar/Navbar';\nimport Footer from './components/MainPage/Footer/Footer';\nimport SignUpForm from './components/SignUp/SignUp';\nimport Notification from './components/MainPage/Notification/Notification';\nimport ForgotPassword from './components/ForgotPassword/ForgotPassword';\nimport CreateProfileForm from \"./components/ProfileCreation/CreateProfileForm\";\nimport ResetPassword from './components/ResetPassword/ResetPassword';\nimport MainPage from './components/MainPage/MainPage';\nimport ValidateProfile from './components/ProfileCreation/ValidateProfile';\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { LOGIN_SUCCESS } from \"./actions/types\";\nimport authActions from './actions/auth';\nimport socketIOClient from 'socket.io-client';\nimport LandingPage from \"./components/LandingPage/LandingPage\";\nimport axios from 'axios';\nconst ENDPOINT = 'http://localhost:3001'; // TODO: is this the right way to do it?\n\nconst socket = socketIOClient(ENDPOINT);\n\nconst App = () => {\n  const dispatch = useDispatch();\n  useEffect(() => {\n    let user = JSON.parse(localStorage.getItem(\"user\")) || null;\n\n    if (user && Math.floor(Date.now() / 1000) >= user.tokenExpiration) {\n      user = null;\n      localStorage.removeItem(\"user\");\n    }\n\n    if (user) {\n      dispatch({\n        type: LOGIN_SUCCESS,\n        payload: {\n          user\n        }\n      });\n      dispatch(authActions.getPosition());\n      socket.emit(\"setUserData\", user);\n      axios.defaults.headers.common['Authorization'] = `Bearer ${user.token}`;\n    }\n  }, [dispatch]);\n\n  const NavRoute = ({\n    exact,\n    path,\n    component: Component\n  }) => /*#__PURE__*/React.createElement(Route, {\n    exact: exact,\n    path: path,\n    render: props => /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Navbar, {\n      socket: socket,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(Component, Object.assign({}, props, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 17\n      }\n    }))),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 9\n    }\n  });\n\n  const {\n    isLoggedIn,\n    user\n  } = useSelector(state => state.auth);\n  if (!isLoggedIn) return /*#__PURE__*/React.createElement(Switch, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Route, {\n    exactly: true,\n    component: SignUpForm,\n    path: \"/signup\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    exactly: true,\n    component: LoginForm,\n    path: \"/login\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    exactly: true,\n    path: \"/reset-password/:resetId\",\n    component: ResetPassword,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    exactly: true,\n    path: \"/validateprofile/:validationId\",\n    component: ValidateProfile,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    exactly: true,\n    component: ForgotPassword,\n    path: \"/forgot-password\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/\",\n    component: LandingPage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 15\n    }\n  }));\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Switch, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(NavRoute, {\n    exactly: true,\n    component: MainPage,\n    path: \"/mainpage\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(NavRoute, {\n    exactly: true,\n    component: Notification,\n    path: \"/notification\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(NavRoute, {\n    exactly: true,\n    component: () => /*#__PURE__*/React.createElement(Messenger, {\n      socket: socket,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 48\n      }\n    }),\n    path: \"/messenger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(NavRoute, {\n    exactly: true,\n    component: Profile,\n    path: \"/profile\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(NavRoute, {\n    exactly: true,\n    component: UserProfile,\n    path: \"/user-profile/:id\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(NavRoute, {\n    exactly: true,\n    component: MyAccount,\n    path: \"/my-account\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    exactly: true,\n    path: \"/profilecreation\",\n    component: CreateProfileForm,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    exactly: true,\n    path: \"/validateprofile/:validationId\",\n    component: ValidateProfile,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 13\n    }\n  }, user.status === 2 ? /*#__PURE__*/React.createElement(Redirect, {\n    to: \"/mainpage\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 38\n    }\n  }) : /*#__PURE__*/React.createElement(Redirect, {\n    to: \"/profilecreation\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 68\n    }\n  }))));\n};\n\nexport default App;","map":{"version":3,"sources":["/opt/lampstack-8.1.7-0/apache2/htdocs/matcha-2.0/client/src/App.js"],"names":["React","useEffect","useState","Switch","Route","Redirect","Messenger","MyAccount","LoginForm","Profile","UserProfile","Navbar","Footer","SignUpForm","Notification","ForgotPassword","CreateProfileForm","ResetPassword","MainPage","ValidateProfile","useSelector","useDispatch","LOGIN_SUCCESS","authActions","socketIOClient","LandingPage","axios","ENDPOINT","socket","App","dispatch","user","JSON","parse","localStorage","getItem","Math","floor","Date","now","tokenExpiration","removeItem","type","payload","getPosition","emit","defaults","headers","common","token","NavRoute","exact","path","component","Component","props","isLoggedIn","state","auth","status"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react';\nimport {\n    Switch,\n    Route,\n    Redirect,\n} from \"react-router-dom\";\n\nimport './App.css';\n\nimport Messenger from './components/MainPage/Messenger/Messenger';\nimport MyAccount from \"./components/MainPage/MyAccount/MyAccount\";\nimport LoginForm from \"./components/LoginForm/LoginForm\";\nimport Profile from './components/MainPage/Profile/Profile';\nimport UserProfile from './components/MainPage/UserProfile/UserProfile';\nimport Navbar from './components/MainPage/Navbar/Navbar';\nimport Footer from './components/MainPage/Footer/Footer';\nimport SignUpForm from './components/SignUp/SignUp'\nimport Notification from './components/MainPage/Notification/Notification';\nimport ForgotPassword from './components/ForgotPassword/ForgotPassword'\nimport CreateProfileForm from \"./components/ProfileCreation/CreateProfileForm\";\nimport ResetPassword from './components/ResetPassword/ResetPassword';\nimport MainPage from './components/MainPage/MainPage';\nimport ValidateProfile from './components/ProfileCreation/ValidateProfile'\nimport {useSelector, useDispatch} from \"react-redux\";\nimport {LOGIN_SUCCESS} from \"./actions/types\";\n\n\nimport authActions from './actions/auth'\n\nimport socketIOClient from 'socket.io-client'\nimport LandingPage from \"./components/LandingPage/LandingPage\";\nimport axios from 'axios';\n\nconst ENDPOINT = 'http://localhost:3001' // TODO: is this the right way to do it?\nconst socket = socketIOClient(ENDPOINT)\n\n\nconst App = () => {\n    const dispatch = useDispatch();\n\n\n    useEffect(() => {\n        let user = JSON.parse(localStorage.getItem(\"user\")) || null;\n        if (user && (Math.floor(Date.now() / 1000)) >= user.tokenExpiration) {\n            user = null;\n            localStorage.removeItem(\"user\")\n        }\n        if (user) {\n            dispatch({\n                type: LOGIN_SUCCESS,\n                payload: {user}\n            })\n            dispatch(authActions.getPosition())\n            socket.emit(\"setUserData\", user);\n            axios.defaults.headers.common['Authorization'] = `Bearer ${ user.token }`;\n        }\n    }, [dispatch])\n\n\n\n\n    const NavRoute = ({exact, path, component: Component}) => (\n        <Route exact={exact} path={path} render={(props) => (\n            <div>\n                <Navbar socket={socket} />\n                <Component {...props}/>\n            </div>\n        )}/>\n    )\n\n\n    const {isLoggedIn, user} = useSelector(state => state.auth);\n\n    if (!isLoggedIn)\n    return  <Switch>\n              <Route exactly component={SignUpForm} path=\"/signup\" />\n              <Route exactly component={LoginForm} path=\"/login\" />\n              <Route exactly path='/reset-password/:resetId' component={ResetPassword} />\n              <Route exactly path='/validateprofile/:validationId' component={ValidateProfile} />\n              <Route exactly component={ForgotPassword} path=\"/forgot-password\" />\n              <Route path=\"/\" component={LandingPage} />\n            </Switch>\n    return (\n        <>\n        <Switch>\n            <NavRoute exactly component={MainPage} path=\"/mainpage\" />\n            <NavRoute exactly component={Notification} path=\"/notification\" />\n            <NavRoute exactly component={() => <Messenger socket={socket} /> }  path=\"/messenger\" />\n            <NavRoute exactly component={Profile} path=\"/profile\" />\n            <NavRoute exactly component={UserProfile} path=\"/user-profile/:id\" />\n            <NavRoute exactly component={MyAccount} path=\"/my-account\" />\n            <Route exactly path='/profilecreation' component={CreateProfileForm} />\n            <Route exactly path='/validateprofile/:validationId' component={ValidateProfile} />\n            <Route path=\"/\">\n                {user.status === 2 ? <Redirect to=\"/mainpage\" /> : <Redirect to=\"/profilecreation\"/> }\n            </Route>\n        </Switch>\n        </>\n    )\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}